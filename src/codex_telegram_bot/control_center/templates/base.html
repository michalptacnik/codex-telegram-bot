<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ page_title or "Control Center" }}</title>
  <link rel="stylesheet" href="/static/control_center.css" />
</head>
<body>
  <a class="skip-link" href="#main-content">Skip to content</a>
  <div id="execution-profile-banner" style="display:none;padding:10px 14px;background:#7f1d1d;color:#fee2e2;font-weight:600;border-bottom:1px solid #ef4444;">
    UNSAFE MODE ENABLED
  </div>
  <div class="layout">
    <aside class="sidebar" aria-label="Primary">
      <div class="brand">Control Center</div>
      <div class="tagline">Codex Telegram Bot</div>
      <nav class="nav" aria-label="Sections">
        <a href="/" class="{% if nav == 'dashboard' %}active{% endif %}" {% if nav == 'dashboard' %}aria-current="page"{% endif %}>Dashboard</a>
        <a href="/onboarding" class="{% if nav == 'onboarding' %}active{% endif %}" {% if nav == 'onboarding' %}aria-current="page"{% endif %}>Onboarding</a>
        <a href="/runs" class="{% if nav == 'runs' %}active{% endif %}" {% if nav == 'runs' %}aria-current="page"{% endif %}>Runs</a>
        <a href="/sessions" class="{% if nav == 'sessions' %}active{% endif %}" {% if nav == 'sessions' %}aria-current="page"{% endif %}>Sessions</a>
        <a href="/chat" class="{% if nav == 'chat' %}active{% endif %}" {% if nav == 'chat' %}aria-current="page"{% endif %}>Chat</a>
        <a href="/costs" class="{% if nav == 'costs' %}active{% endif %}" {% if nav == 'costs' %}aria-current="page"{% endif %}>Costs</a>
        <a href="/approvals" class="{% if nav == 'approvals' %}active{% endif %}" {% if nav == 'approvals' %}aria-current="page"{% endif %}>Approvals</a>
        <a href="/agents" class="{% if nav == 'agents' %}active{% endif %}" {% if nav == 'agents' %}aria-current="page"{% endif %}>Agents</a>
        <a href="/skills" class="{% if nav == 'skills' %}active{% endif %}" {% if nav == 'skills' %}aria-current="page"{% endif %}>Skills</a>
        <a href="/plugins" class="{% if nav == 'plugins' %}active{% endif %}" {% if nav == 'plugins' %}aria-current="page"{% endif %}>Plugins</a>
        <a href="/settings" class="{% if nav == 'settings' %}active{% endif %}" {% if nav == 'settings' %}aria-current="page"{% endif %}>Settings</a>
      </nav>
    </aside>
    <main class="main" id="main-content">
      {% block content %}{% endblock %}
    </main>
  </div>
  <script>
    (async () => {
      try {
        const resp = await fetch("/api/execution-profile");
        if (!resp.ok) return;
        const state = await resp.json();
        if (!state || !state.unsafe_active) return;
        const banner = document.getElementById("execution-profile-banner");
        if (!banner) return;
        const sec = Number(state.seconds_until_unsafe_expiry || 0);
        const hh = Math.floor(sec / 3600);
        const mm = Math.floor((sec % 3600) / 60);
        banner.textContent = `UNSAFE MODE ENABLED â€” arbitrary code execution allowed (expires in ${hh}h ${mm}m)`;
        banner.style.display = "block";
      } catch (_err) {
      }
    })();
  </script>
</body>
</html>
